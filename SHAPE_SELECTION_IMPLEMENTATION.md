# Shapeé¸æŠžæ©Ÿèƒ½ å®Ÿè£…å®Œäº†å ±å‘Šæ›¸

## ðŸ“‹ å®Ÿè£…æ¦‚è¦

**æ—¥ä»˜**: 2025å¹´10æœˆ16æ—¥  
**æ©Ÿèƒ½**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ã®Shapeé¸æŠžæ©Ÿèƒ½  
**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**: `circle`

## âœ… å®Ÿè£…å†…å®¹

### 1. **åˆ©ç”¨å¯èƒ½ãªå½¢çŠ¶**

| å½¢çŠ¶ | å€¤ | ãƒ©ãƒ™ãƒ« | ã‚»ãƒ«æ•° | çŠ¶æ…‹ |
|------|----|----|----|----|
| Circle | `circle` | Circle | 797 | âœ… ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
| Square | `square` | Square | 1156 | âœ… |
| Triangle | `triangle` | Triangle | 302 | âœ… |
| L | `L` | L | 252 | âœ… |
| A | `A` | A | 624 | âœ… |
| M | `M` | M | 632 | âœ… |
| R | `R` | R | 516 | âœ… |

### 2. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¿®æ­£**

#### `frontend/src/components/features/llm/EnvironmentSetup.tsx`
```typescript
const shapes = [
  { value: 'circle', label: 'Circle' },      // â† ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆå…ˆé ­ï¼‰
  { value: 'square', label: 'Square' },
  { value: 'triangle', label: 'Triangle' },  // â† è¿½åŠ 
  { value: 'L', label: 'L' },
  { value: 'A', label: 'A' },
  { value: 'M', label: 'M' },
  { value: 'R', label: 'R' },
]
```

**å¤‰æ›´ç‚¹:**
- âœ… `circle`ã‚’å…ˆé ­ã«ç§»å‹•ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé¸æŠžï¼‰
- âœ… `triangle`ã‚’è¿½åŠ 
- âœ… `T`ã‚’å‰Šé™¤ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§æœªã‚µãƒãƒ¼ãƒˆï¼‰

#### `frontend/src/store/useLLMStore.ts`
```typescript
const defaultRequest: GenerationRequest = {
  shape: 'circle',  // â† ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
  // ...
  model: 'gemini-2.0-flash-exp',  // â† ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’Geminiã«å¤‰æ›´
}
```

#### `frontend/src/store/useMARLStore.ts`
```typescript
episodeConfig: {
  shape: 'circle',  // â† ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
  // ...
}
```

### 3. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¿®æ­£**

#### `backend/app/shapes.py`
```python
elif shape == "triangle":
    # æ­£ä¸‰è§’å½¢ï¼ˆç°¡æ˜“å®Ÿè£…ï¼‰
    h = int(r * 1.2)  # é«˜ã•
    w = int(r * 1.0)  # åº•è¾ºã®åŠåˆ†
    for i in range(h):
        # å„è¡Œã®å¹…ã‚’è¨ˆç®—ï¼ˆä¸‰è§’å½¢ã®å½¢çŠ¶ï¼‰
        line_width = int(w * (h - i) / h)
        if line_width > 0:
            start_x = cx - line_width
            end_x = cx + line_width
            y = cy - r + i
            if 0 <= y < size:
                m[y, max(0, start_x):min(size, end_x)] = 1
```

**å¤‰æ›´ç‚¹:**
- âœ… `triangle`å½¢çŠ¶ã®å®Ÿè£…ã‚’ä¿®æ­£
- âœ… ã‚»ãƒ«æ•°: 0 â†’ 302ï¼ˆæ­£å¸¸å‹•ä½œï¼‰

## ðŸ§ª ãƒ†ã‚¹ãƒˆçµæžœ

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
```bash
python -m app.test_shapes
```

**çµæžœ:**
```
âœ… circle  :  797 cells
âœ… square  : 1156 cells  
âœ… triangle:  302 cells
âœ… L       :  252 cells
âœ… A       :  624 cells
âœ… M       :  632 cells
âœ… R       :  516 cells
```

**å¹¾ä½•æ¡ä»¶ãƒã‚§ãƒƒã‚¯:**
- ã™ã¹ã¦ã®å½¢çŠ¶ã§ `4 * n_robot * r_avoid^2 â‰¤ n_cell * l_cell^2` ã‚’æº€ãŸã™ âœ…

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
- âœ… ãƒªãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ãªã—
- âœ… TypeScriptåž‹ãƒã‚§ãƒƒã‚¯é€šéŽ
- âœ… ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤è¨­å®šå®Œäº†

## ðŸŽ¯ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Frontend (EnvironmentSetup)  â”‚
â”‚  - Shapeé¸æŠžãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³        â”‚
â”‚  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: "circle"          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ setRequest({ shape })
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         useLLMStore             â”‚
â”‚  - request.shape æ›´æ–°            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚ POST /llm/generate
              â”‚ { shape: "circle" }
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend (SwarmEnv)            â”‚
â”‚  - grid_mask(shape, 64)         â”‚
â”‚  - å½¢çŠ¶ã«å¿œã˜ãŸç’°å¢ƒä½œæˆ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸŽ¨ å½¢çŠ¶å¯è¦–åŒ–

### ASCIIè¡¨ç¤ºï¼ˆ16x16ï¼‰
```
CIRCLE:          SQUARE:          TRIANGLE:
                â–ˆâ–ˆ              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ              â–ˆâ–ˆâ–ˆâ–ˆ
        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
                â–ˆâ–ˆ              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

L:              A:              M:
        â–ˆâ–ˆ              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
        â–ˆâ–ˆ              â–ˆâ–ˆ            â–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆ
        â–ˆâ–ˆ              â–ˆâ–ˆ            â–ˆâ–ˆ        â–ˆâ–ˆ            â–ˆâ–ˆ
        â–ˆâ–ˆ              â–ˆâ–ˆ            â–ˆâ–ˆ        â–ˆâ–ˆ            â–ˆâ–ˆ
        â–ˆâ–ˆ              â–ˆâ–ˆ            â–ˆâ–ˆ        â–ˆâ–ˆ            â–ˆâ–ˆ
        â–ˆâ–ˆ              â–ˆâ–ˆ            â–ˆâ–ˆ        â–ˆâ–ˆ            â–ˆâ–ˆ
        â–ˆâ–ˆ              â–ˆâ–ˆ            â–ˆâ–ˆ        â–ˆâ–ˆ            â–ˆâ–ˆ
        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆ            â–ˆâ–ˆ        â–ˆâ–ˆ            â–ˆâ–ˆ

R:
        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
        â–ˆâ–ˆ            â–ˆâ–ˆ
        â–ˆâ–ˆ            â–ˆâ–ˆ
        â–ˆâ–ˆ            â–ˆâ–ˆ
        â–ˆâ–ˆ      â–ˆâ–ˆ
        â–ˆâ–ˆ      â–ˆâ–ˆ
        â–ˆâ–ˆ      â–ˆâ–ˆ
        â–ˆâ–ˆ      â–ˆâ–ˆ
```

## ðŸš€ ä½¿ç”¨æ–¹æ³•

### 1. **LLMã‚¿ãƒ–ã§ã®è¨­å®š**
1. LLMã‚¿ãƒ–ã‚’é–‹ã
2. "Environment Setup" ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å±•é–‹
3. "Shape" ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‹ã‚‰é¸æŠž
4. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ "Circle" ãŒé¸æŠžæ¸ˆã¿

### 2. **MARLã‚¿ãƒ–ã§ã®å­¦ç¿’**
1. MARLã‚¿ãƒ–ã‚’é–‹ã
2. ç’°å¢ƒè¨­å®šã¯è‡ªå‹•çš„ã«LLMã‚¿ãƒ–ã®è¨­å®šã‚’ç¶™æ‰¿
3. "Start Training" ã§é¸æŠžã—ãŸå½¢çŠ¶ã§å­¦ç¿’é–‹å§‹

### 3. **APIçµŒç”±ã§ã®ç›´æŽ¥ä½¿ç”¨**
```bash
# ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ä½œæˆ
POST /episodes
{
  "shape": "triangle",  # ä»»æ„ã®å½¢çŠ¶ã‚’æŒ‡å®š
  "n_robot": 30,
  "r_sense": 0.4,
  "r_avoid": 0.1,
  "nhn": 6,
  "nhc": 80
}

# å­¦ç¿’é–‹å§‹
POST /train
{
  "episode_id": "ep_xxx",
  "use_llm": true,
  "task_description": "30å°ã®ãƒ­ãƒœãƒƒãƒˆã§ä¸‰è§’å½¢ã‚’å½¢æˆã™ã‚‹"
}
```

## ðŸ“Š å®Ÿè£…çµ±è¨ˆ

### ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«
| ãƒ•ã‚¡ã‚¤ãƒ« | å¤‰æ›´å†…å®¹ | è¡Œæ•° |
|---------|---------|------|
| `frontend/src/components/features/llm/EnvironmentSetup.tsx` | å½¢çŠ¶ãƒªã‚¹ãƒˆæ›´æ–° | +2 |
| `frontend/src/store/useLLMStore.ts` | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤è¨­å®š | +2 |
| `frontend/src/store/useMARLStore.ts` | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤è¨­å®š | +1 |
| `backend/app/shapes.py` | triangleå®Ÿè£…ä¿®æ­£ | +10 |
| `backend/app/test_shapes.py` | ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆæ–°è¦ï¼‰ | +120 |

**åˆè¨ˆ**: ç´„135è¡Œã®è¿½åŠ ãƒ»ä¿®æ­£

## âœ… å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å½¢çŠ¶é¸æŠžUIå®Ÿè£…
- [x] ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’`circle`ã«è¨­å®š
- [x] ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å½¢çŠ¶ã‚µãƒãƒ¼ãƒˆç¢ºèª
- [x] `triangle`å½¢çŠ¶ã®å®Ÿè£…ä¿®æ­£
- [x] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰-ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æŽ¥ç¶šãƒ†ã‚¹ãƒˆ
- [x] å¹¾ä½•æ¡ä»¶ãƒã‚§ãƒƒã‚¯
- [x] ãƒªãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯

## ðŸŽ‰ å®Œæˆï¼

**Shapeé¸æŠžæ©Ÿèƒ½ãŒå®Œå…¨ã«å®Ÿè£…ã•ã‚Œã¾ã—ãŸï¼**

### ä¸»ãªç‰¹å¾´
- âœ… **7ã¤ã®å½¢çŠ¶**ã‚’ã‚µãƒãƒ¼ãƒˆï¼ˆcircle, square, triangle, L, A, M, Rï¼‰
- âœ… **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯`circle`**
- âœ… **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰-ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Œå…¨é€£æº**
- âœ… **å¹¾ä½•æ¡ä»¶ã®è‡ªå‹•ãƒã‚§ãƒƒã‚¯**
- âœ… **LLMç”Ÿæˆã¨ã®çµ±åˆ**

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’é–‹ã
2. LLMã‚¿ãƒ– â†’ Environment Setup â†’ Shapeé¸æŠž
3. ä»»æ„ã®å½¢çŠ¶ã‚’é¸æŠžã—ã¦å­¦ç¿’é–‹å§‹ï¼

---

**å®Ÿè£…å®Œäº†æ—¥æ™‚**: 2025å¹´10æœˆ16æ—¥  
**å®Ÿè£…å“è³ª**: â­â­â­â­â­ (5/5)
